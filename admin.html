<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Simples - Dicion√°rio Emakhua</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #2c5282;
            --secondary: #38a169;
            --danger: #e53e3e;
            --light: #f7fafc;
            --dark: #2d3748;
            --border: #e2e8f0;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Login */
        .login-screen {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, var(--primary), #4c51bf);
        }
        
        .login-box {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 400px;
        }
        
        .login-box h2 {
            color: var(--primary);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .form-control {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        /* Painel */
        .panel {
            display: none;
        }
        
        .panel.active {
            display: block;
        }
        
        .header {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            background: white;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .tab {
            padding: 10px 20px;
            border: none;
            background: var(--light);
            color: var(--dark);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: var(--primary);
            color: white;
        }
        
        .tab:hover {
            transform: translateY(-2px);
        }
        
        .content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: #2b6cb0;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: var(--secondary);
            color: white;
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .btn-block {
            width: 100%;
        }
        
        .word-list {
            max-height: 500px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .word-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid var(--border);
        }
        
        .word-item:hover {
            background: var(--light);
        }
        
        .word-info {
            flex: 1;
        }
        
        .word-emakhua {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--primary);
        }
        
        .word-actions {
            display: flex;
            gap: 10px;
        }
        
        .message {
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        
        .success {
            background: #c6f6d5;
            color: #22543d;
            border: 1px solid #9ae6b4;
        }
        
        .error {
            background: #fed7d7;
            color: #742a2a;
            border: 1px solid #fc8181;
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Tela de Login -->
    <div id="loginScreen" class="login-screen">
        <div class="login-box">
            <h2>üîê Administra√ß√£o</h2>
            <p style="text-align: center; color: #666; margin-bottom: 30px;">
                Dicion√°rio Emakhua-Portugu√™s
            </p>
            
            <div class="form-group">
                <label for="password">Senha</label>
                <input type="password" 
                       id="password" 
                       class="form-control"
                       placeholder="Digite a senha de admin">
            </div>
            
            <button class="btn btn-primary btn-block" onclick="login()">
                Entrar
            </button>
            
            <div id="loginError" style="color: var(--danger); margin-top: 15px; text-align: center; display: none;">
                Senha incorreta!
            </div>
        </div>
    </div>
    
    <!-- Painel Administrativo -->
    <div id="adminPanel" class="panel">
        <div class="container">
            <!-- Header -->
            <div class="header">
                <h1>üìù Administra√ß√£o do Dicion√°rio</h1>
                <button class="btn btn-danger" onclick="logout()">
                    Sair
                </button>
            </div>
            
            <!-- Tabs -->
            <div class="tabs">
                <button class="tab active" data-tab="add">‚ûï Adicionar</button>
                <button class="tab" data-tab="list">üìã Listar</button>
                <button class="tab" data-tab="export">üíæ Exportar</button>
                <button class="tab" data-tab="import">üì§ Importar</button>
            </div>
            
            <!-- Mensagens -->
            <div id="message" class="message" style="display: none;"></div>
            
            <!-- Conte√∫do das Tabs -->
            <div id="addTab" class="content tab-content active">
                <h2 style="margin-bottom: 20px;">Adicionar Nova Palavra</h2>
                
                <div class="form-group">
                    <label for="emakhua">Palavra em Emakhua *</label>
                    <input type="text" id="emakhua" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="portugues">Tradu√ß√£o em Portugu√™s *</label>
                    <input type="text" id="portugues" class="form-control" required>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="classe">Classe Gramatical</label>
                        <select id="classe" class="form-control">
                            <option value="">Selecione...</option>
                            <option value="substantivo">Substantivo</option>
                            <option value="verbo">Verbo</option>
                            <option value="adjetivo">Adjetivo</option>
                            <option value="adv√©rbio">Adv√©rbio</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="tom">Padr√£o de Tom</label>
                        <input type="text" id="tom" class="form-control" placeholder="HL, LHL, etc.">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="exemplo_emakhua">Exemplo em Emakhua</label>
                        <textarea id="exemplo_emakhua" class="form-control"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="exemplo_traducao">Tradu√ß√£o do Exemplo</label>
                        <textarea id="exemplo_traducao" class="form-control"></textarea>
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="addWord()">
                    Adicionar Palavra
                </button>
            </div>
            
            <div id="listTab" class="content tab-content">
                <h2 style="margin-bottom: 20px;">Palavras Cadastradas</h2>
                
                <div class="form-group">
                    <input type="text" 
                           id="searchInput" 
                           class="form-control" 
                           placeholder="Buscar palavra..."
                           onkeyup="searchWords()">
                </div>
                
                <div class="word-list" id="wordList">
                    <!-- Lista carregada por JavaScript -->
                </div>
            </div>
            
            <div id="exportTab" class="content tab-content">
                <h2 style="margin-bottom: 20px;">Exportar Dados</h2>
                
                <div style="display: grid; gap: 20px;">
                    <div>
                        <h3>Exportar para JSON</h3>
                        <p style="margin: 10px 0; color: #666;">
                            Exporta todas as palavras para um arquivo JSON.
                        </p>
                        <button class="btn btn-success" onclick="exportJSON()">
                            üìÑ Exportar JSON
                        </button>
                    </div>
                    
                    <div>
                        <h3>Fazer Backup</h3>
                        <p style="margin: 10px 0; color: #666;">
                            Faz backup completo do banco de dados.
                        </p>
                        <button class="btn btn-primary" onclick="backupDatabase()">
                            üíæ Fazer Backup
                        </button>
                    </div>
                    
                    <div>
                        <h3>Exportar para CSV</h3>
                        <p style="margin: 10px 0; color: #666;">
                            Exporta para CSV (Excel/Google Sheets).
                        </p>
                        <button class="btn" onclick="exportCSV()">
                            üìä Exportar CSV
                        </button>
                    </div>
                </div>
            </div>
            
            <div id="importTab" class="content tab-content">
                <h2 style="margin-bottom: 20px;">Importar Dados</h2>
                
                <div style="display: grid; gap: 20px;">
                    <div>
                        <h3>Importar do JSON</h3>
                        <p style="margin: 10px 0; color: #666;">
                            Importe palavras de um arquivo JSON.
                        </p>
                        <input type="file" id="jsonFile" accept=".json" style="margin-bottom: 10px;">
                        <button class="btn btn-primary" onclick="importJSON()">
                            üì§ Importar JSON
                        </button>
                    </div>
                    
                    <div>
                        <h3>Restaurar Backup</h3>
                        <p style="margin: 10px 0; color: #666;">
                            Restaure um backup do banco de dados.
                        </p>
                        <input type="file" id="backupFile" accept=".sqlite" style="margin-bottom: 10px;">
                        <button class="btn btn-success" onclick="restoreBackup()">
                            üîÑ Restaurar Backup
                        </button>
                    </div>
                    
                    <div>
                        <h3>Importar Texto</h3>
                        <p style="margin: 10px 0; color: #666;">
                            Cole palavras no formato: emakhua;portugu√™s;classe;tom
                        </p>
                        <textarea id="importText" class="form-control" rows="6" placeholder="mu…æ√©;c√£o, cachorro;substantivo;HL
muthu;pessoa;substantivo;HL
kulowa;comer;verbo;LHL"></textarea>
                        <button class="btn" onclick="importText()" style="margin-top: 10px;">
                            üìù Importar Texto
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <!-- SQL.js via CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js"></script>
    
    <script>
        // Configura√ß√£o
        const ADMIN_PASSWORD = 'emakhua2026'; // Altere esta senha!
        let db = null;
        let SQL = null;
        
        // ========== INICIALIZA√á√ÉO ==========
        
        // Login
        function login() {
            const password = document.getElementById('password').value;
            const errorDiv = document.getElementById('loginError');
            
            if (password === ADMIN_PASSWORD) {
                initDatabase().then(success => {
                    if (success) {
                        document.getElementById('loginScreen').style.display = 'none';
                        document.getElementById('adminPanel').classList.add('active');
                        loadWordList();
                    } else {
                        errorDiv.textContent = 'Erro ao inicializar banco de dados';
                        errorDiv.style.display = 'block';
                    }
                });
            } else {
                errorDiv.style.display = 'block';
            }
        }
        
        // Inicializar banco de dados
        // No admin-simple.html, modifique estas fun√ß√µes:

// Substituir a fun√ß√£o initDatabase() por:
async function initDatabase() {
    try {
        // Inicializar banco compartilhado
        const success = await SharedDB.init();
        
        if (success) {
            showMessage('‚úÖ Banco carregado com sucesso!', 'success');
            loadWordList();
            setupTabs();
            return true;
        } else {
            showMessage('‚ùå Erro ao carregar banco', 'error');
            return false;
        }
        
    } catch (error) {
        showMessage(`‚ùå ERRO: ${error.message}`, 'error');
        return false;
    }
}

// Substituir a fun√ß√£o addWord() por:
function addWord() {
    const palavra = {
        emakhua: document.getElementById('emakhua').value.trim(),
        portugues: document.getElementById('portugues').value.trim(),
        classe_gramatical: document.getElementById('classe').value || null,
        tom: document.getElementById('tom').value.trim() || null,
        exemplo_emakhua: document.getElementById('exemplo_emakhua').value.trim() || null,
        exemplo_traducao: document.getElementById('exemplo_traducao').value.trim() || null
    };
    
    // Valida√ß√£o
    if (!palavra.emakhua || !palavra.portugues) {
        showMessage('Preencha a palavra em Emakhua e a tradu√ß√£o!', 'error');
        return;
    }
    
    // Usar banco compartilhado
    const resultado = SharedDB.addWord(palavra);
    
    if (resultado.success) {
        // Limpar formul√°rio
        document.getElementById('emakhua').value = '';
        document.getElementById('portugues').value = '';
        document.getElementById('classe').value = '';
        document.getElementById('tom').value = '';
        document.getElementById('exemplo_emakhua').value = '';
        document.getElementById('exemplo_traducao').value = '';
        
        // Atualizar lista
        loadWordList();
        
        showMessage(`‚úÖ "${palavra.emakhua}" adicionada com sucesso! ID: ${resultado.id}`, 'success');
        
        // Disparar evento para atualizar dicion√°rio principal
        dispatchDatabaseUpdate();
    } else {
        showMessage(`‚ùå Erro: ${resultado.error}`, 'error');
    }
}

// Substituir a fun√ß√£o loadWordList() por:
function loadWordList() {
    const palavras = SharedDB.getAllWords();
    const container = document.getElementById('wordList');
    
    if (!palavras || palavras.length === 0) {
        container.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">Nenhuma palavra cadastrada.</p>';
        return;
    }
    
    let html = '';
    
    palavras.forEach(palavra => {
        html += `
            <div class="word-item">
                <div class="word-info">
                    <div class="word-emakhua">${escapeHtml(palavra.emakhua)}</div>
                    <div>${escapeHtml(palavra.portugues)}</div>
                    <small>${palavra.classe_gramatical ? `Classe: ${palavra.classe_gramatical}` : ''} 
                           ${palavra.tom ? ` | Tom: ${palavra.tom}` : ''}</small>
                </div>
                <div class="word-actions">
                    <button class="btn btn-danger" style="padding: 5px 10px; font-size: 0.9rem;" 
                            onclick="deleteWord(${palavra.id})">
                        Excluir
                    </button>
                </div>
            </div>
        `;
    });
    
    container.innerHTML = html;
}

// Adicionar fun√ß√£o deleteWord() no banco compartilhado:
function deleteWord(id) {
    if (!confirm('Tem certeza que deseja excluir esta palavra?')) {
        return;
    }
    
    try {
        // Desativar palavra (n√£o excluir fisicamente)
        SharedDB.db.run('UPDATE palavras SET ativo = 0 WHERE id = ?', [id]);
        SharedDB.saveToLocalStorage();
        
        // Atualizar lista
        loadWordList();
        
        showMessage('‚úÖ Palavra exclu√≠da com sucesso!', 'success');
        
        // Disparar evento para atualizar dicion√°rio principal
        dispatchDatabaseUpdate();
        
    } catch (error) {
        showMessage(`‚ùå Erro: ${error.message}`, 'error');
    }
}

// Fun√ß√£o para disparar evento de atualiza√ß√£o
function dispatchDatabaseUpdate() {
    // Disparar evento personalizado
    const event = new CustomEvent('databaseUpdated', {
        detail: { timestamp: new Date().toISOString() }
    });
    window.dispatchEvent(event);
    
    // Tamb√©m salvar no localStorage como sinal
    localStorage.setItem('db_last_update', new Date().toISOString());
}
        
        // Criar tabelas
        function createTables() {
            try {
                db.run(`
                    CREATE TABLE IF NOT EXISTS palavras (
                        id INTEGER PRIMARY KEY AUTOINCREMENT,
                        emakhua TEXT NOT NULL,
                        portugues TEXT NOT NULL,
                        classe_gramatical TEXT,
                        tom TEXT,
                        exemplo_emakhua TEXT,
                        exemplo_traducao TEXT,
                        data_cadastro DATETIME DEFAULT CURRENT_TIMESTAMP
                    )
                `);
                
                // Salvar no localStorage
                saveToLocalStorage();
                
            } catch (error) {
                console.error('Erro ao criar tabelas:', error);
            }
        }
        
        // ========== FUN√á√ïES PRINCIPAIS ==========
        
        // Adicionar palavra
        function addWord() {
            const palavra = {
                emakhua: document.getElementById('emakhua').value.trim(),
                portugues: document.getElementById('portugues').value.trim(),
                classe_gramatical: document.getElementById('classe').value || null,
                tom: document.getElementById('tom').value.trim() || null,
                exemplo_emakhua: document.getElementById('exemplo_emakhua').value.trim() || null,
                exemplo_traducao: document.getElementById('exemplo_traducao').value.trim() || null
            };
            
            // Valida√ß√£o
            if (!palavra.emakhua || !palavra.portugues) {
                showMessage('Preencha a palavra em Emakhua e a tradu√ß√£o!', 'error');
                return;
            }
            
            try {
                const stmt = db.prepare(`
                    INSERT INTO palavras (emakhua, portugues, classe_gramatical, tom, exemplo_emakhua, exemplo_traducao)
                    VALUES (?, ?, ?, ?, ?, ?)
                `);
                
                stmt.run([
                    palavra.emakhua,
                    palavra.portugues,
                    palavra.classe_gramatical,
                    palavra.tom,
                    palavra.exemplo_emakhua,
                    palavra.exemplo_traducao
                ]);
                
                stmt.free();
                
                // Salvar altera√ß√µes
                saveToLocalStorage();
                
                // Limpar formul√°rio
                document.getElementById('emakhua').value = '';
                document.getElementById('portugues').value = '';
                document.getElementById('classe').value = '';
                document.getElementById('tom').value = '';
                document.getElementById('exemplo_emakhua').value = '';
                document.getElementById('exemplo_traducao').value = '';
                
                // Atualizar lista
                loadWordList();
                
                showMessage(`‚úÖ "${palavra.emakhua}" adicionada com sucesso!`, 'success');
                
            } catch (error) {
                showMessage(`‚ùå Erro: ${error.message}`, 'error');
            }
        }
        
        // Buscar palavras
        function searchWords() {
            const termo = document.getElementById('searchInput').value.toLowerCase();
            
            if (!db) return;
            
            try {
                let result;
                
                if (termo) {
                    const stmt = db.prepare(`
                        SELECT * FROM palavras 
                        WHERE emakhua LIKE ? OR portugues LIKE ?
                        ORDER BY emakhua
                    `);
                    
                    stmt.bind([`%${termo}%`, `%${termo}%`]);
                    
                    const words = [];
                    while (stmt.step()) {
                        words.push(stmt.get());
                    }
                    stmt.free();
                    
                    result = { values: words };
                } else {
                    result = db.exec('SELECT * FROM palavras ORDER BY emakhua');
                }
                
                const container = document.getElementById('wordList');
                
                if (!result || result.length === 0 || result[0].values.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">Nenhuma palavra encontrada.</p>';
                    return;
                }
                
                const words = result[0]?.values || result.values || [];
                let html = '';
                
                words.forEach(word => {
                    const wordArray = Array.isArray(word) ? word : word;
                    html += `
                        <div class="word-item">
                            <div class="word-info">
                                <div class="word-emakhua">${escapeHtml(wordArray[1])}</div>
                                <div>${escapeHtml(wordArray[2])}</div>
                                <small>${wordArray[3] ? `Classe: ${wordArray[3]}` : ''} ${wordArray[4] ? ` | Tom: ${wordArray[4]}` : ''}</small>
                            </div>
                            <div class="word-actions">
                                <button class="btn btn-danger" style="padding: 5px 10px; font-size: 0.9rem;" 
                                        onclick="deleteWord(${wordArray[0]})">
                                    Excluir
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
                
            } catch (error) {
                console.error('Erro na busca:', error);
            }
        }
        
        // Excluir palavra
        function deleteWord(id) {
            if (!confirm('Tem certeza que deseja excluir esta palavra?')) {
                return;
            }
            
            try {
                db.run('DELETE FROM palavras WHERE id = ?', [id]);
                saveToLocalStorage();
                loadWordList();
                showMessage('‚úÖ Palavra exclu√≠da com sucesso!', 'success');
            } catch (error) {
                showMessage(`‚ùå Erro: ${error.message}`, 'error');
            }
        }
        
        // ========== EXPORTA√á√ÉO ==========
        
        // Exportar JSON
        function exportJSON() {
            if (!db) return;
            
            try {
                const result = db.exec('SELECT * FROM palavras');
                const words = result.length > 0 ? result[0].values : [];
                
                const data = {
                    palavras: words.map(word => ({
                        id: word[0],
                        emakhua: word[1],
                        portugues: word[2],
                        classe_gramatical: word[3],
                        tom: word[4],
                        exemplo_emakhua: word[5],
                        exemplo_traducao: word[6],
                        data_cadastro: word[7]
                    })),
                    metadata: {
                        export_date: new Date().toISOString(),
                        total_words: words.length,
                        version: '1.0'
                    }
                };
                
                const jsonString = JSON.stringify(data, null, 2);
                const blob = new Blob([jsonString], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `emakhua-dicionario-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                
                URL.revokeObjectURL(url);
                
                showMessage('‚úÖ JSON exportado com sucesso!', 'success');
                
            } catch (error) {
                showMessage(`‚ùå Erro: ${error.message}`, 'error');
            }
        }
        
        // Fazer backup
        function backupDatabase() {
            if (!db) return;
            
            try {
                const data = db.export();
                const blob = new Blob([data], { type: 'application/octet-stream' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `emakhua-backup-${new Date().toISOString().split('T')[0]}.sqlite`;
                a.click();
                
                URL.revokeObjectURL(url);
                
                showMessage(`‚úÖ Backup criado! (${Math.round(data.byteLength / 1024)} KB)`, 'success');
                
            } catch (error) {
                showMessage(`‚ùå Erro: ${error.message}`, 'error');
            }
        }
        
        // Exportar CSV
        function exportCSV() {
            if (!db) return;
            
            try {
                const result = db.exec('SELECT * FROM palavras');
                const words = result.length > 0 ? result[0].values : [];
                
                // Cabe√ßalhos
                const headers = ['ID', 'Emakhua', 'Portugu√™s', 'Classe', 'Tom', 'Exemplo Emakhua', 'Exemplo Tradu√ß√£o', 'Data'];
                
                // Linhas
                const csvRows = [
                    headers.join(','),
                    ...words.map(word => [
                        word[0],
                        `"${word[1]}"`,
                        `"${word[2]}"`,
                        `"${word[3] || ''}"`,
                        `"${word[4] || ''}"`,
                        `"${word[5] || ''}"`,
                        `"${word[6] || ''}"`,
                        `"${word[7] || ''}"`
                    ].join(','))
                ];
                
                const csvString = csvRows.join('\n');
                const blob = new Blob([csvString], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `emakhua-palavras-${new Date().toISOString().split('T')[0]}.csv`;
                a.click();
                
                URL.revokeObjectURL(url);
                
                showMessage(`‚úÖ CSV exportado com ${words.length} palavras!`, 'success');
                
            } catch (error) {
                showMessage(`‚ùå Erro: ${error.message}`, 'error');
            }
        }
        
        // ========== IMPORTAR ==========
        
        // Importar JSON
        function importJSON() {
            const fileInput = document.getElementById('jsonFile');
            const file = fileInput.files[0];
            
            if (!file) {
                showMessage('Selecione um arquivo JSON', 'error');
                return;
            }
            
            if (!confirm('Esta a√ß√£o ir√° substituir todos os dados atuais. Continuar?')) {
                return;
            }
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    // Limpar tabela atual
                    db.run('DELETE FROM palavras');
                    
                    // Inserir novas palavras
                    if (data.palavras && Array.isArray(data.palavras)) {
                        const stmt = db.prepare(`
                            INSERT INTO palavras (emakhua, portugues, classe_gramatical, tom, exemplo_emakhua, exemplo_traducao)
                            VALUES (?, ?, ?, ?, ?, ?)
                        `);
                        
                        data.palavras.forEach(palavra => {
                            stmt.run([
                                palavra.emakhua,
                                palavra.portugues,
                                palavra.classe_gramatical,
                                palavra.tom,
                                palavra.exemplo_emakhua,
                                palavra.exemplo_traducao
                            ]);
                        });
                        
                        stmt.free();
                    }
                    
                    // Salvar altera√ß√µes
                    saveToLocalStorage();
                    
                    // Atualizar lista
                    loadWordList();
                    
                    showMessage(`‚úÖ ${data.palavras?.length || 0} palavras importadas!`, 'success');
                    
                } catch (error) {
                    showMessage(`‚ùå Erro ao importar JSON: ${error.message}`, 'error');
                }
            };
            
            reader.readAsText(file);
        }
        
        // Restaurar backup
        function restoreBackup() {
            const fileInput = document.getElementById('backupFile');
            const file = fileInput.files[0];
            
            if (!file) {
                showMessage('Selecione um arquivo de backup', 'error');
                return;
            }
            
            if (!confirm('Esta a√ß√£o ir√° substituir TODOS os dados atuais. Continuar?')) {
                return;
            }
            
            const reader = new FileReader();
            
            reader.onload = async function(e) {
                try {
                    // Fechar banco atual
                    if (db) {
                        db.close();
                    }
                    
                    // Carregar novo banco
                    const data = new Uint8Array(e.target.result);
                    db = new SQL.Database(data);
                    
                    // Salvar no localStorage
                    saveToLocalStorage();
                    
                    // Atualizar lista
                    loadWordList();
                    
                    showMessage('‚úÖ Backup restaurado com sucesso!', 'success');
                    
                } catch (error) {
                    showMessage(`‚ùå Erro ao restaurar backup: ${error.message}`, 'error');
                }
            };
            
            reader.readAsArrayBuffer(file);
        }
        
        // Importar texto
        function importText() {
            const text = document.getElementById('importText').value.trim();
            
            if (!text) {
                showMessage('Digite ou cole o texto para importar', 'error');
                return;
            }
            
            if (!confirm('Esta a√ß√£o adicionar√° novas palavras ao banco. Continuar?')) {
                return;
            }
            
            try {
                const linhas = text.split('\n');
                let contador = 0;
                
                const stmt = db.prepare(`
                    INSERT INTO palavras (emakhua, portugues, classe_gramatical, tom)
                    VALUES (?, ?, ?, ?)
                `);
                
                linhas.forEach(linha => {
                    const campos = linha.split(';').map(campo => campo.trim());
                    
                    if (campos.length >= 2) {
                        stmt.run([
                            campos[0],
                            campos[1],
                            campos[2] || null,
                            campos[3] || null
                        ]);
                        contador++;
                    }
                });
                
                stmt.free();
                
                // Salvar altera√ß√µes
                saveToLocalStorage();
                
                // Atualizar lista
                loadWordList();
                
                // Limpar campo
                document.getElementById('importText').value = '';
                
                showMessage(`‚úÖ ${contador} palavras importadas!`, 'success');
                
            } catch (error) {
                showMessage(`‚ùå Erro: ${error.message}`, 'error');
            }
        }
        
        // ========== UTILIT√ÅRIOS ==========
        
        // Configurar tabs
        function setupTabs() {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.dataset.tab;
                    
                    // Atualizar tabs ativas
                    document.querySelectorAll('.tab').forEach(t => {
                        t.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Mostrar conte√∫do correto
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(tabId + 'Tab').classList.add('active');
                });
            });
        }
        
        // Salvar no localStorage
        function saveToLocalStorage() {
            if (!db) return;
            
            try {
                const data = db.export();
                const dataString = JSON.stringify(Array.from(new Uint8Array(data)));
                localStorage.setItem('emakhua_database', dataString);
            } catch (error) {
                console.error('Erro ao salvar:', error);
            }
        }
        
        // Mostrar mensagem
        function showMessage(text, type) {
            const messageDiv = document.getElementById('message');
            messageDiv.textContent = text;
            messageDiv.className = `message ${type}`;
            messageDiv.style.display = 'block';
            
            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 5000);
        }
        
        // Logout
        function logout() {
            if (confirm('Deseja sair do painel administrativo?')) {
                location.reload();
            }
        }
        
        // Escapar HTML
        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
    </script>
// Adicionar no final do arquivo admin-simple.html:
<script src="shared-database.js"></script>
</body>
</html>
